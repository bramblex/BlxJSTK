(function(e,d){(function(b,c){c=c||b;b=Array.isArray(b)&&b||[];if("function"===typeof d&&d.amd)d(b,c);else if("function"===typeof d&&d.cmd)d(b,function(h,d,f){f.exports=c.apply(e,b.map(function(a){return h(a)}))});else if("object"===typeof exports)module.exports=c.apply(e,b.map(function(b){return require(b)}));else{var f=document.currentScript.src.replace(/(^.*?)([^\/]+)\.(js)(\?.*$|$)/,"$2"),f=f.replace(".min","");e[f]=c.apply(e,b.map(function(b){return e[b.replace(/^.*\//,"")]}))}})(["./EventEmitter"],
function(b){var c=/^\s*([\w\*]+)\s*\(\s*(\w+)\s*\)\s*=>\s*(\w+)\s*$/,d=/\*/,e=function(a){return a.filter(function(a,b,l){return l.indexOf(a)===b})},k=function(a){var b=[];a.forEach(function(a,c,e){d.test(a.current_state)||b.push(a.current_state);b.push(a.next_state)});var b=e(b),c={};a.forEach(function(a,d,e){d=a.sign;var f=a.input;e=a.current_state;var g=a.next_state;c[f]||(c[f]={});if("normal"===d)c[f][e]=g;else if("wildcrad"===d){var h=RegExp("^"+e.replace("*","\\w+")+"$");b.filter(function(a,
b,c){return h.test(a)}).forEach(function(a,b,d){c[f][a]=g})}});return{result:c,states_list:b}},g=b.extend("FSM").method("constructor",function(){g.uper("constructor").apply(this);this.__rules__={};this.__states_list__=[];this.state=null;this.rules=[]}).method("rule",function(a){if(this.state)throw"Error: FSM is aready ran!";if(c.test(a))return this.rules.push(a),this;throw"Error: "+a;}).method("start",function(a){if(this.state)throw"Error: FSM is aready ran!";var b=k(this.rules);this.__rules__=b.result;
this.__states_list__=b.__states_list__;if(0>__states_list__.indexOf(a))throw"Error: state not found!";this.state=a;this.emit("start",a);return this}).method("input",function(a){if(!this.state)throw"Error: FSM is not runing!";if(this.__rules__[a]&&this.__rules__[a][this.state]){var b=this.__rules__[a][this.state];this.emit("change",this.state,b,a);this.emit(this.state+"end",a);this.emit(this.state+"to"+b,a);this.state=b;this.emit(b+"enter",a);return this}throw"Error: "+a;}).method("clone",function(){if(!this.state)throw"Error: FSM is not runing!";
var a=this.__class__();a.rules=this.rules;a.__rules__=this.__rules__;a.__states_list__=this.__states_list__;a.start(this.state);return a});return g})})(this,"undefined"!==typeof define&&define);
